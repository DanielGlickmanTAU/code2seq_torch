computes distances weights onces, uses the same weights in all the layers.



graphormer_graph_encoder:
    atten_bias = GraphAttenBias.compute(bias)
    x = Multihead_att(x, atten_bias)






Graphomer Graph encoder : https://github.com/microsoft/Graphormer/blob/main/graphormer/modules/graphormer_graph_encoder.py #216
---
Graph atten bias : https://github.com/microsoft/Graphormer/blob/main/graphormer/modules/graphormer_layers.py
        self.spatial_pos_encoder = nn.Embedding(num_spatial, num_heads, padding_idx=0)
        ....
        # [n_graph, n_node, n_node, n_head] -> [n_graph, n_head, n_node, n_node]
        spatial_pos_bias = self.spatial_pos_encoder(spatial_pos).permute(0, 3, 1, 2)

----
https://github.com/microsoft/Graphormer/blob/main/graphormer/modules/multihead_attention.py
    if attn_bias is not None:
                attn_weights += attn_bias.view(bsz * self.num_heads, tgt_len, src_len)


